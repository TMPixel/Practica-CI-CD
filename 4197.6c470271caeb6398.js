"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4197],{4197:(B,v,l)=>{l.r(v),l.d(v,{HomePageModule:()=>V});var p=l(177),a=l(4341),s=l(1075),_=l(4964),m=l(467),e=l(4438),h=l(1738),P=l(5265),U=l(9381),b=l(3683);function k(o,r){if(1&o&&(e.j41(0,"ion-avatar"),e.nrm(1,"img",13),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("src",i.form.value.image,e.B4B)}}function F(o,r){1&o&&e.nrm(0,"ion-icon",14)}function y(o,r){1&o&&(e.j41(0,"div"),e.EFF(1,"El nombre es requerido"),e.k0s())}function I(o,r){1&o&&(e.j41(0,"div"),e.EFF(1,"Ingrese al menos 4 caracteres"),e.k0s())}function R(o,r){if(1&o&&(e.j41(0,"div",15),e.DNE(1,y,2,0,"div",4)(2,I,2,0,"div",4),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.form.controls.name.errors?null:i.form.controls.name.errors.required),e.R7$(),e.Y8G("ngIf",null==i.form.controls.name.errors?null:i.form.controls.name.errors.minlenght)}}function $(o,r){1&o&&(e.j41(0,"div"),e.EFF(1,"El precio es requerido"),e.k0s())}function G(o,r){1&o&&(e.j41(0,"div"),e.EFF(1,"El precio m\xednimo debe ser 0"),e.k0s())}function T(o,r){if(1&o&&(e.j41(0,"div",15),e.DNE(1,$,2,0,"div",4)(2,G,2,0,"div",4),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.form.controls.price.errors?null:i.form.controls.price.errors.required),e.R7$(),e.Y8G("ngIf",null==i.form.controls.price.errors?null:i.form.controls.price.errors.min)}}function j(o,r){1&o&&(e.j41(0,"div"),e.EFF(1,"Las unidades son requerido"),e.k0s())}function E(o,r){1&o&&(e.j41(0,"div"),e.EFF(1,"Las unidades m\xednimo debe ser 0"),e.k0s())}function S(o,r){if(1&o&&(e.j41(0,"div",15),e.DNE(1,j,2,0,"div",4)(2,E,2,0,"div",4),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngIf",null==i.form.controls.soldUnits.errors?null:i.form.controls.soldUnits.errors.required),e.R7$(),e.Y8G("ngIf",null==i.form.controls.soldUnits.errors?null:i.form.controls.soldUnits.errors.min)}}let C=(()=>{var o;class r{constructor(){this.utilsSrv=(0,e.WQX)(P.T),this.firebaseSvc=(0,e.WQX)(h.f),this.form=new a.gE({id:new a.MJ(""),image:new a.MJ("",[a.k0.required]),name:new a.MJ("",[a.k0.required,a.k0.minLength(4)]),price:new a.MJ(null,[a.k0.required,a.k0.min(0)]),soldUnits:new a.MJ(null,[a.k0.required,a.k0.min(0)])}),this.user={}}ngOnInit(){}takeImage(){var t=this;return(0,m.A)(function*(){const n=(yield t.utilsSrv.takePicture("Imagen del producto")).dataUrl;t.form.controls.image.setValue(n)})()}submit(){this.form.valid&&(this.product?this.updateProduct():this.createProduct())}createProduct(){var t=this;return(0,m.A)(function*(){let n=`users/${t.user.uid}/products`;const d=yield t.utilsSrv.loading();yield d.present();let c=t.form.value.image,u=`${t.user.uid}/${Date.now()}`,f=yield t.firebaseSvc.uploadImage(u,c);t.form.controls.image.setValue(f),delete t.form.value.id,t.firebaseSvc.addDocument(n,t.form.value).then(function(){var g=(0,m.A)(function*(w){t.utilsSrv.dismissModal({success:!0}),t.utilsSrv.showToast({message:"Producto creado exitosamente",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(w){return g.apply(this,arguments)}}()).catch(g=>{console.log(g),t.utilsSrv.showToast({message:g.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{d.dismiss()})})()}updateProduct(){var t=this;return(0,m.A)(function*(){let n=`users/${t.user.uid}/products/${t.product.id}`;const d=yield t.utilsSrv.loading();yield d.present();let c=t.form.value.image;if(c!==t.product.image){yield t.firebaseSvc.deleteFile(t.product.image);let u=`${t.user.uid}/${Date.now()}`,f=yield t.firebaseSvc.uploadImage(u,c);t.form.controls.image.setValue(f)}delete t.form.value.id,t.firebaseSvc.updateDocument(n,t.form.value).then(function(){var u=(0,m.A)(function*(f){t.utilsSrv.dismissModal({success:!0}),t.utilsSrv.showToast({message:"Producto actualizado exitosamente",duration:1500,color:"success",position:"middle",icon:"checkmark-circle-outline"})});return function(f){return u.apply(this,arguments)}}()).catch(u=>{console.log(u),t.utilsSrv.showToast({message:u.message,duration:2500,color:"primary",position:"middle",icon:"alert-circle-outline"})}).finally(()=>{d.dismiss()})})()}}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-add-update-product"]],inputs:{product:"product"},decls:18,vars:14,consts:[[3,"isModal","title"],[3,"fullscreen"],[1,"d-flex-center"],[1,"auth-form",3,"ngSubmit","keypres.enter","formGroup"],[4,"ngIf"],["class","image-icon","name","image-outline",4,"ngIf"],["mode","ios","size","small","shape","round",3,"click"],["autocomplete","name","type","text","label","Nombre",3,"control"],["class","validators",4,"ngIf"],["type","number","label","Precio",3,"control"],["type","number","label","Unidades Vendidas",3,"control"],["type","submit","mode","ios",1,"ion-margin",3,"disabled"],["slot","end","name","checkmark-circle-outline"],[3,"src"],["name","image-outline",1,"image-icon"],[1,"validators"]],template:function(t,n){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content",1)(2,"div",2)(3,"form",3),e.bIt("ngSubmit",function(){return n.submit()})("keypres.enter",function(){return n.submit()}),e.DNE(4,k,2,1,"ion-avatar",4)(5,F,1,0,"ion-icon",5),e.nrm(6,"br"),e.j41(7,"ion-button",6),e.bIt("click",function(){return n.takeImage()}),e.EFF(8," Tomar/Seleccionar "),e.k0s(),e.nrm(9,"app-custom-input",7),e.DNE(10,R,3,2,"div",8),e.nrm(11,"app-custom-input",9),e.DNE(12,T,3,2,"div",8),e.nrm(13,"app-custom-input",10),e.DNE(14,S,3,2,"div",8),e.j41(15,"ion-button",11),e.EFF(16),e.nrm(17,"ion-icon",12),e.k0s()()()()),2&t&&(e.Y8G("isModal",!0)("title",n.product?"Actualizar Producto":"Registrar Producto"),e.R7$(),e.Y8G("fullscreen",!0),e.R7$(2),e.Y8G("formGroup",n.form),e.R7$(),e.Y8G("ngIf",n.form.value.image),e.R7$(),e.Y8G("ngIf",!n.form.value.image),e.R7$(4),e.Y8G("control",n.form.controls.name),e.R7$(),e.Y8G("ngIf",n.form.controls.name.errors&&n.form.controls.name.touched),e.R7$(),e.Y8G("control",n.form.controls.price),e.R7$(),e.Y8G("ngIf",n.form.controls.price.errors&&n.form.controls.price.touched),e.R7$(),e.Y8G("control",n.form.controls.soldUnits),e.R7$(),e.Y8G("ngIf",n.form.controls.soldUnits.errors&&n.form.controls.soldUnits.touched),e.R7$(),e.Y8G("disabled",n.form.invalid),e.R7$(),e.SpI(" ",n.product?"Actualizar producto":"Agregar producto"," "))},dependencies:[p.bT,s.mC,s.Jm,s.W9,s.iq,a.qT,a.cb,a.j4,U.l,b.H],styles:[".image-icon[_ngcontent-%COMP%]{font-size:100px;opacity:30%}ion-avatar[_ngcontent-%COMP%]{width:200px;height:160px;--border-radius: 15px;margin:0 auto}"]}),r})();var A=l(2784);function M(o,r){if(1&o&&(e.j41(0,"ion-card",8)(1,"div")(2,"h5"),e.EFF(3),e.k0s(),e.j41(4,"p"),e.EFF(5,"Productos"),e.k0s()(),e.j41(6,"div")(7,"h5"),e.EFF(8),e.nI1(9,"currency"),e.k0s(),e.j41(10,"p"),e.EFF(11,"Ganancias"),e.k0s()()()),2&o){const i=e.XpG();e.R7$(3),e.JRh(i.products.length),e.R7$(5),e.JRh(e.i5U(9,2,i.getProfits(),"USD"))}}function Y(o,r){if(1&o){const i=e.RV6();e.j41(0,"ion-item-sliding",10)(1,"ion-item")(2,"ion-avatar",11),e.nrm(3,"img",12),e.k0s(),e.j41(4,"ion-label")(5,"div",13),e.EFF(6),e.k0s(),e.j41(7,"div",14)(8,"strong"),e.EFF(9,"Precio:"),e.k0s(),e.EFF(10),e.nI1(11,"currency"),e.nrm(12,"br"),e.j41(13,"strong"),e.EFF(14,"Unidades Vendidas:"),e.k0s(),e.EFF(15),e.k0s(),e.j41(16,"ion-chip",15)(17,"ion-label"),e.EFF(18),e.nI1(19,"currency"),e.k0s()()()(),e.j41(20,"ion-item-options")(21,"ion-item-option",6),e.bIt("click",function(){const n=e.eBV(i).$implicit,d=e.XpG(2);return e.Njj(d.addUpdateProduct(n))}),e.nrm(22,"ion-icon",16),e.k0s(),e.j41(23,"ion-item-option",17),e.bIt("click",function(){const n=e.eBV(i).$implicit,d=e.XpG(2);return e.Njj(d.confirmDeleteProduct(n))}),e.nrm(24,"ion-icon",18),e.k0s()()()}if(2&o){const i=r.$implicit;e.R7$(3),e.Y8G("src",i.image,e.B4B),e.R7$(3),e.SpI("",i.name," "),e.R7$(4),e.SpI(" ",e.i5U(11,5,i.price,"USD")," "),e.R7$(5),e.SpI(" ",i.soldUnits," "),e.R7$(3),e.SpI("Ganancia: ",e.i5U(19,8,i.price*i.soldUnits,"USD"),"")}}function H(o,r){if(1&o&&(e.j41(0,"ion-list"),e.DNE(1,Y,25,11,"ion-item-sliding",9),e.k0s()),2&o){const i=e.XpG();e.R7$(),e.Y8G("ngForOf",i.products)}}function D(o,r){1&o&&(e.j41(0,"div",19),e.nrm(1,"ion-icon",20),e.j41(2,"h3"),e.EFF(3,"No hay productos disponibles"),e.k0s()())}const x=[{path:"",component:(()=>{var o;class r{constructor(){this.utilsSrv=(0,e.WQX)(P.T),this.firebaseSrv=(0,e.WQX)(h.f),this.products=[],this.loading=!1}user(){return this.utilsSrv.getFromLocalStorage("user")}ionViewWillEnter(){this.getProducts()}doRefresh(t){setTimeout(()=>{this.getProducts(),t.target.complete()},1e3)}getProfits(){return this.products.reduce((t,n)=>t+n.price*n.soldUnits,0)}getProducts(){let t=`users/${this.user().uid}/products`;console.log(t),this.loading=!0;let n=[(0,A.My)("soldUnits","desc")],d=this.firebaseSrv.getCollectionData(t,n).subscribe({next:c=>{console.log(c),this.products=c,this.loading=!1,d.unsubscribe()}})}addUpdateProduct(t){var n=this;return(0,m.A)(function*(){yield n.utilsSrv.presentModal({component:C,cssClass:"add-update-modal",componentProps:{product:t}}),n.getProducts()})()}confirmDeleteProduct(t){}}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.VBU({type:o,selectors:[["app-home"]],decls:10,vars:4,consts:[["title","Inicio :3",3,"showMenu"],["slot","fixed","pullFactor","0.8","pullMin","60","pullMax","120",3,"ionRefresh"],["mode","ios","color","secondary","class","d-flex-center ion-text-center",4,"ngIf"],[4,"ngIf"],["class","empty",4,"ngIf"],["vertical","bottom","horizontal","end","slot","fixed"],[3,"click"],["name","add"],["mode","ios","color","secondary",1,"d-flex-center","ion-text-center"],["class","product-item",4,"ngFor","ngForOf"],[1,"product-item"],["slot","start"],[3,"src"],[1,"name"],[1,"data"],["color","primary","mode","ios","outline","true"],["name","create-outline",1,"option-btn"],["color","danger",3,"click"],["name","trash-outline",1,"option-btn"],[1,"empty"],["name","shield-outline"]],template:function(t,n){1&t&&(e.nrm(0,"app-header",0),e.j41(1,"ion-content")(2,"ion-refresher",1),e.bIt("ionRefresh",function(c){return n.doRefresh(c)}),e.nrm(3,"ion-refresher-content"),e.k0s(),e.DNE(4,M,12,5,"ion-card",2)(5,H,2,1,"ion-list",3)(6,D,4,0,"div",4),e.j41(7,"ion-fab",5)(8,"ion-fab-button",6),e.bIt("click",function(){return n.addUpdateProduct()}),e.nrm(9,"ion-icon",7),e.k0s()()()),2&t&&(e.Y8G("showMenu",!0),e.R7$(4),e.Y8G("ngIf",!n.loading&&n.products.length),e.R7$(),e.Y8G("ngIf",!n.loading),e.R7$(),e.Y8G("ngIf",!n.loading&&!n.products.length))},dependencies:[p.Sq,p.bT,s.mC,s.b_,s.ZB,s.W9,s.Q8,s.YW,s.iq,s.uz,s.LU,s.CE,s.A7,s.he,s.nf,s.To,s.Ki,U.l,p.oe]}),r})()}];let N=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[_.iI.forChild(x),_.iI]}),r})();var X=l(3887);let V=(()=>{var o;class r{}return(o=r).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.MD,a.YN,s.bv,N,X.G]}),r})()}}]);